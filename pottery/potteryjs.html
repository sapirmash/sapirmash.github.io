<!DOCTYPE html>
<html lang="en">
  <head>
    <title></title>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WZKTHFCL4B"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-WZKTHFCL4B');
    </script>
    <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <link href="https://fonts.googleapis.com/css2?family=Work+Sans&display=swap" rel="stylesheet">
          <script src="FileSaver.js-master/src/FileSaver.js"></script>
          <link rel="stylesheet" href="ceremic.css">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script>
            <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.ui.min.js"></script>
            <!-- <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/2.0.6/velocity.min.js"></script> -->
            <!-- <script src="//cdnjs.cloudflare.com/ajax/libs/velocity/2.0.6/velocity.ui.min.js"></script> -->
          </head>
          <body>
            <div id="explainiphone">
          Sorry, this website can't be viewed on your device.
          Please open it on your desktop.
          </div>
            <header class="header" id="headerstart">
              <div id="index">Pottery.js</div>
              <div class= "infoclass" id="info">Info</div>
            </header>
            <div id="about">
              <div class="desc">
                 Pottery is one of the oldest human inventions, with first appearances more than 20,000 years ago.
                 This project makes the process of designing such objects accessible through a digital medium, using <a href="https://threejs.org/" style="color: #382826">Three.js</a>. 
                 You can modify an existing design or create one from scratch and export your design to an STL file for 3D printing.
<!-- 
                 <br>
                 <br>
                 Want to be featured? export your work of art to a link, then send it <a href="mailto:mash.sapir@gmail.com" style="color: #382826">here</a>
                 </br>
                 </br> -->
                 <br>
                 <br>
                 <br>
                 <br>
                 Made by <a href="https://www.instagram.com/sapir__m/" style="color:#382826">Sapir Mashiach</a>
                 </br>
                 </br>
                 </br>
                 </br>
                </div>
            </div>
            <div id="transitionWrapper"></div>
            <section class="grid-wrapper" id="wrapper">
              <div class="vase-wrapper">
                <h1 class="vase-name">T-01</h1>
                <a class="image-wrapper figure" style="padding-bottom: 125%">
                  <img class="vase-image" id="vase1" src="./Vase(1)new.jpg">
                  </a>
                </div>
                <div class="vase-wrapper">
                  <h1 class="vase-name">T-02</h1>
                  <a  class="image-wrapper figure" style="
                        padding-bottom: 125%">
                    <img class="vase-image" id="vase2" src="./Vase(2)new.jpg">
                    </a>
                  </div>
                  <div class="vase-wrapper">
                    <h1 class="vase-name">T-03</h1>
                    <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                      <img class="vase-image" id="vase3" src="./Vase(3)new.jpg">
                      </a>
                    </div>
                    <div class="vase-wrapper">
                      <h1 class="vase-name">T-04</h1>
                      <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                        <img class="vase-image" id="vase4" src="./Vase(4)new.jpg">
                        </a>
                      </div>
                      <div class="vase-wrapper">
                        <h1 class="vase-name">T-05</h1>
                        <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                          <img class="vase-image" id="vase5" src="./Vase(5)new.jpg">
                          </a>
                        </div>
                        <div class="vase-wrapper">
                          <h1 class="vase-name">T-06</h1>
                          <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                            <img class="vase-image" id="vase6" src="./Vase(6)new.jpg">
                            </a>
                          </div>
                          <div class="vase-wrapper">
                          <h1 class="vase-name">T-07</h1>
                          <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                            <img class="vase-image" id="vase7" src="./Vase (7).jpg">
                            </a>
                          </div>
                          <div class="vase-wrapper">
                          <h1 class="vase-name">T-08</h1>
                          <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                            <img class="vase-image" id="vase8" src="./Vase (10).jpg">
                            </a>
                          </div>
                            <div class="vase-wrapper">
                          <h1 class="vase-name">T-09</h1>
                          <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                            <img class="vase-image" id="vase9" src="./Vase (9).jpg">
                            </a>
                          </div>
                            <div class="vase-wrapper">
                          <h1 class="vase-name" style="color: #E8DDDA;">+</h1>
                          <a class="image-wrapper figure" style="
                        padding-bottom: 125%">
                            <img class="vase-image" id="vase10" src="./Vase (8).jpg">
                            </a>
                          </div>
                        </section>


                        <div id="container">

                          <div id="try">Rotate</div>
                          <div class="nav">
                             <div>
                              <button class="closed_panel" id="edit">Edit</button>
                            </div>
                             <div id="close">
                              <a href="./potteryjs.html" class="close">Gallery</a>
                            </div>
                          </div>
                          <div id="vasename">T- 01</div>
                          <div class="footer">
                            <div class="nav-footer">
                              <button id="pre">Previous</button>
                              <button id="next">Next</button>
                            </div>
                          </div>
                          <div id="controls">
                            <div class="scroll">
                            <button class="accordion">General</button>
                            <div class="general panel">
                              <ul>
                                <li class="block">
                                  <span class="title">Top Diameter</span>
                                  <!-- <span>(</span> -->
                                  <output for="radiusTopslider" id="out1"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="radiusTopslider" min="0.1" max="3" step ="0.01"/>
                                </li>
                                <li class="block">
                                  <span class="title">Bottom Diameter</span>
                                  <!-- <span>(</span> -->
                                  <output for="radiusBottom" id="out2"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="radiusBottom" min="0.1" max="3" step ="0.01"/>
                                </li>
                                <li class="block">
                                  <h class="title">Height</h>
                                  <!-- <span>(</span> -->
                                  <output for="height" id="out3"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="height" min="8" max="15" step ="0.01"/>
                                </li>
                              </ul>
                            </div>
                            <button class="accordion">Lip</button>
                            <div class="lip panel">
                              <ul>
                                <div class="block">
                                  <h class="title">Width</h>
                                  <!-- <span>(</span> -->
                                  <output for="mouthWidth" id="out17"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="mouthWidth" min="0.1" max="3" step ="0.01"/>
                                </div>
                                <div class="block is active">
                                  <h class="title">Curve</h>
                                  <!-- <span>(</span> -->
                                  <output for="mouthCurve" id="out16"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="mouthCurve" min="0.1" max="3" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Curve Offset</h>
                                  <!-- <span>(</span> -->
                                  <output for="mouthOffset" id="out18"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="mouthOffset" min="-1" max="5" step ="0.01"/>
                                </div>
                              </ul>
                            </div>
                            <button class="accordion">Neck</button>
                            <!--neck-->
                            <div class="neck panel">
                              <ul>
                                <div class="block">
                                  <h class="title">Start</h>
                                  <!-- <span>(</span> -->
                                  <output for="neckTop" id="out12"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="neckTop" min="2" max="8" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Width</h>
                                  <!-- <span>(</span> -->
                                  <output for="neckWidth" id="out14"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="neckWidth" min="0.1" max="4"  step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Curve</h>
                                  <!-- <span>(</span> -->
                                  <output for="neckCurve" id="out13"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="neckCurve" min="0.1" max="3" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Curve Offset</h>
                                  <!-- <span>(</span> -->
                                  <output for="neckOffset" id="out15"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="neckOffset" min="-2" max="4.8" step ="0.01"/>
                                </div>
                              </ul>
                            </div>
                            <button class="accordion">Body</button>
                            <!--belly-->
                            <div class="belly panel">
                              <ul class="mybelly">
                                <div class="block">
                                  <h class="title">Start</h>
                                  <!-- <span>(</span> -->
                                  <output for="bellyTop" id="out8"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="bellyTop" min="-1" max="10" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Width</h>
                                  <!-- <span>(</span> -->
                                  <output for="bellyWidth" id="out10"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="bellyWidth" min="0.2" max="4"  step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Curve</h>
                                  <!-- <span>(</span> -->
                                  <output for="bellyCurve" id="out9"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="bellyCurve" min="0.1" max="3.2" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Curve Offset</h>
                                  <!-- <span>(</span> -->
                                  <output for="bellyOffset" id="out11"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="bellyOffset" min="-1" max="4.2" step ="0.01"/>
                                </div>
                              </ul>
                            </div>
                            <button class="accordion">Foot</button>
                            <!--leg-->
                            <div class="leg panel">
                              <ul class="myleg">
                                <div class="block">
                                  <h class="title">Start</h>
                                  <!-- <span>(</span> -->
                                  <output for="legTop" id="out4"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="legTop" min="-8" max="-5" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Width</h>
                                  <!-- <span>(</span> -->
                                  <output for="legWidth" id="out6"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="legWidth" min="0" max="3" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Curve</h>
                                  <!-- <span>(</span> -->
                                  <output for="legCurve" id="out5"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="legCurve" min="0.1" max="3" step ="0.01"/>
                                </div>
                                <div class="block">
                                  <h class="title">Curve Offset</h>
                                  <!-- <span>(</span> -->
                                  <output for="legOffset" id="out7"></output>
                                  <!-- <span>)</span> -->
                                  <input type="range" id="legOffset" min="-3.9" max="3" step ="0.01"/>
                                </div>
                              </ul>
                            </div>
                            <button class="accordion">Glaze</button>
                            <div class="materials panel">
                              <button id="glazed" class="glazed-m">Glazed</button>
                              <button id="clay" class="selected clay-m">Unglazed</button>
                            </div>
                            <button class="accordion acc_colors" >Color</button>
                            <div class="colors panel">
                              <button id="brown" class="selected shade">Terracotta</button>
                              <button id="pink" class="shade">Pink</button>
                              <button id="yellow" class="shade">Mocha</button>
                              <button id="white" class="shade">Off-White</button>
                            </div>
                            </div>
                            <div class="actions">
                              <button id="reset">Reset</button>
                              <button id="export">Export</button>
                              <!-- <button id="link">Copy Link</button> -->
                         <!-- <button id="image">Download Image</button> -->
                            </div>
                          </div>
                          <div class="cursor" style="display: none;">
                            <img src="reset.png">
                          </div>
                        </div>
                        <div class="modal">
                        <div class="save-overlay">    
                        <div class="content-overlay">
                            <button id="save">Download.STL</button>
                            <button id="link">Copy Link</button>
                        </div>
                         <a href='#' class="save-overlay__close">
                            Close <!-- &times; --></a>
                        </div>
                        </div>
                        <!-- <div id="info"><a href="https://threejs.org" target="_blank" rel="noopener"></a> -->
                      </div>

<script type="text/javascript">

  

  function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
    vars[key] = value;
    });
    return vars;
  }



  // ######################################## ENTRY POINT ########################################
  var parameters = getUrlVars();


  if (Object.keys(parameters).length > 0) {
    $('.vase-wrapper').addClass("onstart");
    $("#container").fadeIn(100);
    document.getElementById("vasename").innerHTML = "";
    document.getElementById("headerstart").innerHTML = "";
  }
  
// var acc = document.getElementsByClassName("accordion");
var acc = document.getElementsByClassName("accordion");
var panel = document.getElementsByClassName('panel');

var i;
var j;

$('.accordion').each(function(){

for (j = 0; j < acc.length; j++) {
  acc[j].addEventListener("click", function() {
    this.classList.toggle("open");
    var panel = this.nextElementSibling;
    
    if (panel.style.maxHeight) {
      panel.style.maxHeight = null;
    } else {
      panel.style.maxHeight = panel.scrollHeight + "px";
    } 
  });
}

for (i = 0; i < acc.length; i++) {
    acc[i].onclick = function() {
      var setClasses = !this.classList.contains('is-active');
        setClass(acc, 'active', 'remove');
        setClass(panel, 'show', 'remove');
        
        if (setClasses) {
            this.classList.toggle("is-active");
            this.nextElementSibling.classList.toggle("show");
        }
    }
}
});

function setClass(els, className, fnName) {
    for (var i = 0; i < els.length; i++) {
        els[i].classList[fnName](className);
    }
}


$('.image-wrapper').mouseenter(function()
  { $(this).addClass('hover');
    $(this).removeClass('figure')}
);

$('.image-wrapper').mouseleave(function()
  { $(this).addClass('figure');
       $(this).removeClass('hover')}
);
</script>
				 
	<script type="module">		       
			import * as THREE from '/pottery/build/three.module.js';
			import { OrbitControls } from '/pottery/examples/jsm/controls/OrbitControls.js';
			import { Reflector } from '/pottery/examples/jsm/objects/Reflector.js';
			import { RGBELoader } from '/pottery/examples/jsm/loaders/RGBELoader.js';
			import { GUI } from '/pottery/examples/jsm/libs/dat.gui.module.js';
			import { RectAreaLightUniformsLib } from '/pottery/examples/jsm/lights/RectAreaLightUniformsLib.js';			
      // scene size
			var WIDTH = window.innerWidth;
			var HEIGHT = window.innerHeight;

			var SHADOW_MAP_WIDTH = WIDTH, SHADOW_MAP_HEIGHT = HEIGHT;

			// camera
			var VIEW_ANGLE = 35;
			var ASPECT = WIDTH / HEIGHT;
			var NEAR = 1;
			var FAR = 25000;

			var camera, scene, renderer, light1, cube, controls;
			var mouseX = 0, mouseY = 0;
  		var windowHalfX = window.innerWidth / 2;
      var windowHalfY = window.innerHeight / 2;

			var material_new;
			var dirLight;
			
      //bottomcap
      var capBottomGeo;
      var capBottomMat;
      var capBottomMesh;

      //new code
			var cylinder5;
			var cylinderGeom5;		
			var update = false;
			var counter = 0;

      var x_cylinder = 0;
      var y_cylinder = -30;
      var z_cylinder = 120;

			var array_of_functions = [
			   drawVase1,
			   drawVase2,
			   drawVase3,
			   drawVase4,
			   drawVase5,
			   drawVase6,
         drawVase7,
         drawVase8,
         drawVase9,
         drawVase10
			];

			var vases_names = [
			   'T-01',
			   'T-02',
			   'T-03',
			   'T-04',
			   'T-05',
			   'T-06',
         'T-07',
         'T-08',
         'T-09',
         ''
			];

			registerEventHandlers();
			init();
      
       function render(){
        // camera.position.x += ( mouseX - camera.position.x ) * .05;
            // camera.position.y = THREE.Math.clamp( camera.position.y + ( - ( mouseY - 600 ) - camera.position.y ) * .05, 50, 1000 );
            // dirLight.position.x += ( mouseX - dirLight.position.x - 1000 ) * .05;
        // camera.lookAt( scene.position );
        renderer.render( scene, camera );
      }

      function animate(){ 
      requestAnimationFrame(animate);
      render();
      cylinder5.verticesNeedUpdate = true;
      cylinder5.elementsNeedUpdate = true;
      }

      function drawVaseFromParameters(parameters){

      x_cylinder = 0;
      y_cylinder = 20;
      z_cylinder = 120;

      if (parameters['c']==='brown'){
        colorbrown();
      }
      if (parameters['c']==='pink'){
        colorpink();
      }
      if (parameters['c']==='yellow'){
        coloryellow();
      }
      if (parameters['c']==='white'){
        colorwhite();
      }

      if (parameters['g']==='0') {
        glazed();
      }
      else{
        clay();
      }

      document.getElementById("vasename").innerHTML = "";
      document.getElementById("radiusTopslider").value = parameters['t'];
      document.getElementById("radiusBottom").value = parameters['b'];
      document.getElementById("height").value = parameters['h'];

      document.getElementById("mouthWidth").value = parameters['mw'];
      document.getElementById("mouthCurve").value = parameters['mc'];
      document.getElementById("mouthOffset").value = parameters['mo'];

      document.getElementById("neckTop").value = parameters['ns'];
      document.getElementById("neckWidth").value = parameters['nw'];
      document.getElementById("neckCurve").value = parameters['nc'];
      document.getElementById("neckOffset").value = parameters['no'];

      document.getElementById("bellyTop").value = parameters['bs'];
      document.getElementById("bellyWidth").value = parameters['bw'];
      document.getElementById("bellyCurve").value = parameters['bc'];
      document.getElementById("bellyOffset").value = parameters['bo'];

      document.getElementById("legTop").value = parameters['ls'];
      document.getElementById("legWidth").value = parameters['lw'];
      document.getElementById("legCurve").value = parameters['lc'];
      document.getElementById("legOffset").value = parameters['lo'];      
      trigger("input", "mouthOffset");

      }

			drawVase1(); 
			update = true;
			showVal(0);

      var changeCursor = true;
      
        $("#export").on("click", function() {
        changeCursor = false;
        $(".save-overlay, .content-overlay, .modal").addClass("active_overlay");
        });
      

        $(".save-overlay__close").on("click", function() {
          changeCursor = true;
        $(".save-overlay, .content-overlay, .modal").removeClass("active_overlay");
      });
      
      if (Object.keys(parameters).length > 0) {
        $("#container").fadeIn(100);
        document.getElementById("vasename").innerHTML = "";
        drawVaseFromParameters(parameters);
        animate();
      }


			function reset(){
			array_of_functions[counter%array_of_functions.length]();			
			update = true;
			cylinderGeom5.verticesNeedUpdate = true;
			trigger("input", "mouthOffset");
			}

			
      function save(){
				saveSTL( scene, vases_names[counter%vases_names.length] );
			}


			function showVal(val){
				if (!update){
					return;
				}
  		     	var radiusTop = document.getElementById("radiusTopslider").value;
  		     	var radiusBottom = document.getElementById("radiusBottom").value;
  		     	var height = document.getElementById("height").value;

  		     	var legTop = document.getElementById("legTop").value;
  		     	var legCurve = document.getElementById("legCurve").value;
  		     	var legWidth = document.getElementById("legWidth").value;
  		     	var legOffset = document.getElementById("legOffset").value;

  		     	var bellyTop = document.getElementById("bellyTop").value;
  		     	var bellyWidth = document.getElementById("bellyWidth").value;
  		     	var bellyOffset = document.getElementById("bellyOffset").value;
  		     	var bellyCurve = document.getElementById("bellyCurve").value;

  		     	var neckTop = document.getElementById("neckTop").value;
  		     	var neckCurve = document.getElementById("neckCurve").value;
  		     	var neckOffset = document.getElementById("neckOffset").value;
  		     	var neckWidth = document.getElementById("neckWidth").value;

  		     	var mouthCurve = document.getElementById("mouthCurve").value;
  		     	var mouthOffset = document.getElementById("mouthOffset").value;
  		     	var mouthWidth = document.getElementById("mouthWidth").value;

		     	  var output = document.getElementById("out1");
		        output.value = radiusTop;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out2");
		        output.value = radiusBottom;
		        output.style.zIndex = "3";

				    var output = document.getElementById("out3");
		        output.value = height;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out4");
		        output.value = legTop;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out5");
		        output.value = legCurve;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out6");
		        output.value = legWidth;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out7");
		        output.value = legOffset;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out8");
		        output.value = bellyTop;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out9");
		        output.value = bellyCurve;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out10");
		        output.value = bellyWidth;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out11");
		        output.value = bellyOffset;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out12");
		        output.value = neckTop;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out13");
		        output.value = neckCurve;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out14");
		        output.value = neckWidth;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out15");
		        output.value = neckOffset;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out16");
		        output.value = mouthCurve;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out17");
		        output.value = mouthWidth;
		        output.style.zIndex = "3";

		        var output = document.getElementById("out18");
		        output.value = mouthOffset;
		        output.style.zIndex = "3";

		        var materialId;
		        if ($('#glazed').hasClass('selected')) {
		        	materialId = 0;
		        }
		        else{
		        	materialId = 1;
		        }

		        var color;

		        // var brown = "#D18462";
		        // var pink = "#E3A091";
		        // var yellow = "#C79D85";
		        // var white = "#C7BFB4";

            var brown = "#D18462";
            var pink = "#D08572";
            var yellow = "#CA9D85";
            var white = "#DEBAA0";

		        if ($('#brown').hasClass('selected')) {
		        	color= brown;
		        }
		        if ($('#pink').hasClass('selected')) {
		        	color= pink;
		        }
		        if ($('#yellow').hasClass('selected')) {
		        	color= yellow;
		        }
		        if ($('#white').hasClass('selected')) {
		        	color= white;
		        }
		       
		        drawVase(
		        	Number(radiusTop), 
		        	Number(radiusBottom),  
		        	Number(height), 
		        	Number(legTop), 
		        	Number(legCurve), 
		        	Number(legWidth),
		        	Number(legOffset),
		        	Number(bellyTop),
		        	Number(bellyCurve),
		        	Number(bellyWidth),
		        	Number(bellyOffset),
		        	Number(neckTop),
		        	Number(neckCurve),
		        	Number(neckWidth),
		        	Number(neckOffset),
		        	Number(mouthCurve),
		        	Number(mouthWidth),
		        	Number(mouthOffset),
		        	materialId,
		        	color	
		        	);
        	}


          function getUrlWithParameters(){

            var url = new URL(window.location.href);

            var radiusTop = document.getElementById("radiusTopslider").value;
            url.searchParams.append('t', radiusTop); 
            var radiusBottom = document.getElementById("radiusBottom").value;
            url.searchParams.append('b', radiusBottom);
            var height = document.getElementById("height").value;
            url.searchParams.append('h', height);

            var mouthWidth = document.getElementById("mouthWidth").value;
            url.searchParams.append('mw', mouthWidth);
            var mouthCurve = document.getElementById("mouthCurve").value;
            url.searchParams.append('mc', mouthCurve);
            var mouthOffset = document.getElementById("mouthOffset").value;
            url.searchParams.append('mo', mouthOffset);
            

            var neckTop = document.getElementById("neckTop").value;
            url.searchParams.append('ns', neckTop);
            var neckWidth = document.getElementById("neckWidth").value;
            url.searchParams.append('nw', neckWidth);
            var neckCurve = document.getElementById("neckCurve").value;
            url.searchParams.append('nc', neckCurve);
            var neckOffset = document.getElementById("neckOffset").value;
            url.searchParams.append('no', neckOffset);
           

            var bellyTop = document.getElementById("bellyTop").value;
            url.searchParams.append('bs', bellyTop);
            var bellyWidth = document.getElementById("bellyWidth").value;
            url.searchParams.append('bw', bellyWidth);
            var bellyCurve = document.getElementById("bellyCurve").value;
            url.searchParams.append('bc', bellyCurve);
            var bellyOffset = document.getElementById("bellyOffset").value;
            url.searchParams.append('bo', bellyOffset);

            var legTop = document.getElementById("legTop").value;
            url.searchParams.append('ls', legTop);
            var legWidth = document.getElementById("legWidth").value;
            url.searchParams.append('lw', legWidth);
            var legCurve = document.getElementById("legCurve").value;
            url.searchParams.append('lc', legCurve);
            var legOffset = document.getElementById("legOffset").value;
            url.searchParams.append('lo', legOffset);


            if ($('#brown').hasClass('selected')) {
              url.searchParams.append('c', 'brown');
            }
            if ($('#pink').hasClass('selected')) {
              url.searchParams.append('c', 'pink');
            }
            if ($('#yellow').hasClass('selected')) {
              url.searchParams.append('c', 'yellow');
            }
            if ($('#white').hasClass('selected')) {
              url.searchParams.append('c', 'white');
            }

            if ($('#glazed').hasClass('selected')) {
              url.searchParams.append('g', '0');
            }
            else{
              url.searchParams.append('g', '1');
            }
            return url;

          }

    
          function Copy() {
          var $temp = $("<input>");
          var url = getUrlWithParameters();

            $("body").append($temp);
            $temp.val(url).select();
            document.execCommand("copy");
            $temp.remove();

          }

           $(document).ready( function() {
            $("#link").click(function(){
            $(this).html("Copied");
            setTimeout(function() {
                $("#link").html("Copy link");
              }, 2000);
            });
        });

                    
        	function registerEventHandlers(){
        		// set event handlers
			      	// document.addEventListener( 'mousemove', onDocumentMouseMove, false );
	            // document.addEventListener( 'wheel', onDocumentWheel, false );
	            document.addEventListener('mousemove', onMouseMove, true);
	            document.getElementById('edit').addEventListener( 'click', myFunction);
	            document.getElementById('reset').addEventListener( 'click', reset);
	            document.getElementById('save').addEventListener( 'click', save);
              // document.getElementById('export').addEventListener( 'click', Export);
              document.getElementById('link').addEventListener( 'click', Copy);
              // document.getElementById('image').addEventListener( 'click', createImage);

	            document.getElementById('glazed').addEventListener( 'click', glazed);
	            document.getElementById('clay').addEventListener('click', clay);
	            
      				var next = document.getElementById('next').addEventListener( 'click', onNextClick);
      				var pre = document.getElementById('pre').addEventListener( 'click', onPreClick);

      				var radiusTopslider = document.getElementById( 'radiusTopslider' ).addEventListener('input', showVal);
      				var radiusBottom = document.getElementById( 'radiusBottom' ).addEventListener('input', showVal);
      				var height = document.getElementById( 'height' ).addEventListener('input', showVal);

      				var legTop = document.getElementById( 'legTop' ).addEventListener('input', showVal);
      				var legCurve = document.getElementById( 'legCurve' ).addEventListener('input', showVal);
      				var legWidth = document.getElementById( 'legWidth' ).addEventListener('input', showVal);
      				var legOffset = document.getElementById( 'legOffset' ).addEventListener('input', showVal);

      				var bellyTop = document.getElementById( 'bellyTop' ).addEventListener('input', showVal);
      				var bellyWidth = document.getElementById( 'bellyWidth' ).addEventListener('input', showVal);
      				var bellyOffset = document.getElementById( 'bellyOffset' ).addEventListener('input', showVal);
      				var bellyCurve = document.getElementById( 'bellyCurve' ).addEventListener('input', showVal);

      				var neckTop = document.getElementById( 'neckTop' ).addEventListener('input', showVal);
      				var neckCurve = document.getElementById( 'neckCurve' ).addEventListener('input', showVal);
      				var neckWidth = document.getElementById( 'neckWidth' ).addEventListener('input', showVal);
      				var neckOffset = document.getElementById( 'neckOffset' ).addEventListener('input', showVal);

      				var mouthCurve = document.getElementById( 'mouthCurve' ).addEventListener('input', showVal);
      				var mouthWidth = document.getElementById( 'mouthWidth' ).addEventListener('input', showVal);
      				var mouthOffset = document.getElementById( 'mouthOffset' ).addEventListener('input', showVal);

      				//about
      				// document.querySelector('#info').addEventListener('click', infoclick);
              // document.querySelector('#edit').addEventListener('click', editonclick);

      				//colors
      				document.querySelector('#brown').addEventListener('click', colorbrown );
      				document.querySelector('#pink').addEventListener('click', colorpink);
      				document.querySelector('#yellow').addEventListener('click', coloryellow);
      				document.querySelector('#white').addEventListener('click', colorwhite);

      				//grid 
      				document.querySelector('#vase1').addEventListener('click', click);
      				document.querySelector('#vase2').addEventListener('click', click);
      				document.querySelector('#vase3').addEventListener('click', click);
              document.querySelector('#vase4').addEventListener('click', click);
              document.querySelector('#vase5').addEventListener('click', click);
              document.querySelector('#vase6').addEventListener('click', click);
              document.querySelector('#vase7').addEventListener('click', click);
              document.querySelector('#vase8').addEventListener('click', click);
				      document.querySelector('#vase9').addEventListener('click', click);
              document.querySelector('#vase10').addEventListener('click', click);  
      }




      function getPos(el) {
       var rect=el.getBoundingClientRect();
       return {x:rect.left,y:rect.top};
      }

      function click(event){
            if(event.currentTarget.id == 'vase1'){
              counter=0;
              drawVase1();  
            }
            if(event.currentTarget.id == 'vase2'){
              counter=1;
              drawVase2();  
            }
            if(event.currentTarget.id == 'vase3'){
              counter=2;
              drawVase3();  
            }
            if(event.currentTarget.id == 'vase4'){
              counter=3;
              drawVase4();  
            }    
            if(event.currentTarget.id == 'vase5'){
              counter=4;
              drawVase5();  
            }  
            if(event.currentTarget.id == 'vase6'){
              counter=5;
              drawVase6();  
            }  
            if(event.currentTarget.id == 'vase7'){
              counter=6;
              drawVase7();  
            } 
            if(event.currentTarget.id == 'vase8'){
              counter=7;
              drawVase8();  
            } 
            if(event.currentTarget.id == 'vase9'){
              counter=8;
              drawVase9();  
            } 
            if(event.currentTarget.id == 'vase10'){
              counter=9;
              drawVase10();  
            }          
            $('#' + event.currentTarget.id).removeClass("inactive");

            var coords = getPos(document.querySelector('#' + event.currentTarget.id));

            // create custom class
            // var style = document.createElement('style');
            // style.type = 'text/css';
            // style.innerHTML = '.animation-start { height: ' + $('#vase1').height() + '; width: ' + $('#vase1').width() + '; top: ' + coords.y + '; left: ' + coords.x + '; position: fixed; display: block; }';
            // document.getElementsByTagName('head')[0].appendChild(style);

            var $el = $('#'+event.currentTarget.id).clone().attr('id', 'vaseclone').css({
            position: 'fixed',
            top: coords.y,
            left: coords.x,
            display: 'block',
            width: $('#'+event.currentTarget.id).width(),
            height: $('#'+event.currentTarget.id).height(),
            opacity: "1"
            });

            $('#transitionWrapper').append($el);
            // document.getElementById('vaseclone').className = 'animation-start';
            // $el.removeClass("animation-start");
            $el.addClass("animation-finished");
            $el.velocity({
                top: "50%",
                left: "50%",
                // translateX: "-53%",
                // translateY: "-41%",
                translateX: "-50%",
                translateY: "-50%",
                position:"fixed",
                display: "block",
                textalign: "center",
                scale: "2"
              },
                {
                /* Velocity's default options */
                duration: 400,
                easing: "ease-in-out",
                loop: false,
                delay: 600
             });
            $el.velocity({
                opacity: "0",
              },
                {
                duration: 1000,
                loop: false,
                delay: 600
             });
            // $("#container").velocity("fadeIn", {display: "block"}, { delay: 1600, duration: 400 });
            
            $('.vase-wrapper').addClass("inactive");
            $(".header").addClass("inactive");
            $("h1").addClass("inactive");
            $('.grid-wrapper').addClass("after");
            // $('.inactive').fadeOut(600);
            // $('.active').animate({ "left": "50%", "top": "50%" },"slow").delay(1000).fadeOut(1000);
            // $('.active').fadeOut(200);
            $("#container").delay(1300).fadeIn(300);
            animate();
        		    		
        	}

          $('#info').click(function(){
              var $this = $(this);
              if($this.hasClass('infoclass')){
                $this.text('Gallery');
                // $(".grid-wrapper").velocity("fadeOut", { duration: 500 });    
                // $("#about").velocity("fadeIn", { delay: 300, duration: 100 });
                $("#about").delay(300).fadeIn(200);
                $("section").fadeOut(500);    
              } else {
                $this.text('Info');
                $("section").delay(100).fadeIn(500);
                $("#about").fadeOut(100);    
              }
              $this.toggleClass('infoclass');
            });


          $('#edit').click(function(){
              var $this = $(this);
              $this.toggleClass('closed_panel');
              if($this.hasClass('closed_panel')){
                $this.text('Edit');     
              } else {
                $this.text('Close');
              }
            });

        	function colorbrown(){
        		$('#brown').addClass('selected');
    				$('#white').removeClass('selected');
    				$('#yellow').removeClass('selected');
    				$('#pink').removeClass('selected');
    				update= true;
    				showVal(0);
        	}

          function colorwhite(){
            $('#white').addClass('selected');
    				$('#brown').removeClass('selected');
    				$('#yellow').removeClass('selected');
    				$('#pink').removeClass('selected');
    				update= true;
    				showVal(0);
          }

        	function coloryellow(){
        		$('#yellow').addClass('selected');
    				$('#white').removeClass('selected');
    				$('#brown').removeClass('selected');
    				$('#pink').removeClass('selected');
    				update= true;
    				showVal(0);
          	}

        	function colorpink(){
        		$('#pink').addClass('selected');
    				$('#white').removeClass('selected');
    				$('#yellow').removeClass('selected');
    				$('#brown').removeClass('selected');
    				update= true;
    				showVal(0);
        	}

          const fitCameraToObject = function ( camera, object, offset, controls ) {

    offset = offset || 1.25;

    const boundingBox = new THREE.Box3();

    // get bounding box of object - this will be used to setup controls and camera
    boundingBox.setFromObject( object );

    const center = boundingBox.getCenter();

    const size = boundingBox.getSize();

    // get the max side of the bounding box (fits to width OR height as needed )
    const maxDim = Math.max( size.x, size.y, size.z );
    const fov = camera.fov * ( Math.PI / 180 );
    let cameraZ = Math.abs( maxDim / 4 * Math.tan( fov * 2 ) );

    cameraZ *= offset; // zoom out a little so that objects don't fill the screen

    camera.position.z = cameraZ;

    const minZ = boundingBox.min.z;
    const cameraToFarEdge = ( minZ < 0 ) ? -minZ + cameraZ : cameraZ - minZ;

    camera.far = cameraToFarEdge * 3;
    camera.updateProjectionMatrix();

    if ( controls ) {

      // set camera to rotate around center of loaded object
      controls.target = center;

      // prevent camera from zooming out far enough to create far plane cutoff
      controls.maxDistance = cameraToFarEdge * 2;

      controls.saveState();

    } else {

        camera.lookAt( center )

   }

}

        
			function init() {

    					var container = document.getElementById( 'container' );

    					// scene
    					scene = new THREE.Scene();

    					// renderer
    					renderer = new THREE.WebGLRenderer( { antialias: true, preserveDrawingBuffer: true } );
    					renderer.setPixelRatio( window.devicePixelRatio );
    					// renderer.setSize( WIDTH, HEIGHT );
    					renderer.setSize($(container).width(), $(container).height());
    					container.appendChild( renderer.domElement );
    					renderer.setClearColor('#E8DDDA');
    					renderer.shadowMap.enabled = true;
	        		renderer.shadowMap.type = THREE.PCFSoftShadowMap;

    					// camera
    					camera = new THREE.PerspectiveCamera( VIEW_ANGLE, ASPECT, NEAR, FAR );
    					camera.position.z = 2300;
	        		camera.position.y = 700;

              // camera.position.z = 2300;
              // camera.position.y = 700;

	        		controls = new OrbitControls( camera, renderer.domElement );
	        		controls.minDistance = 2300;
    					controls.maxDistance = 200;
    					controls.maxPolarAngle = Math.PI/2;
              controls.enablePan = false;
              controls.enableRotate = true;
              controls.rotateSpeed = 1.0;
    					controls.update();


              
			
        			//LIGHTS
        		  // light1 = new THREE.SpotLight( 0xffffff, 0.3, 0, Math.PI / 2 );
			        // light1.position.set( 2000, 4000, -3000 );
			        // light1.target.position.set( 1, 1, 1 );
			        // light1.castShadow = true;

			        // light1.shadow = new THREE.LightShadow( new THREE.PerspectiveCamera( 20, 10, 100, 20000 ) );
			        // light1.shadow.bias = 0.0001;
			        // light1.shadow.camera.near = NEAR;
			        // light1.shadow.camera.far = FAR;
			        // light1.shadow.camera.fov = 15;

			        // light1.shadow.mapSize.width = SHADOW_MAP_WIDTH;
			        // light1.shadow.mapSize.height = SHADOW_MAP_HEIGHT;

			        // light1.shadow.camera.right =  50000;
			        // light1.shadow.camera.left = -50000;
			        // light1.shadow.camera.top = 50000;
			        // light1.shadow.camera.bottom = -50000;

			        // hemiLight.position.set( 100, 600, 0 );
			        // dirLight.position.set( -3000, 4000, 3000 );

			        var hemiLight = new THREE.HemisphereLight( 0xffffff, 0xffffff, 0.8 );
  				    hemiLight.position.set( 0, 500, 0 );
  				    scene.add( hemiLight );

    				  // const helper1 = new THREE.HemisphereLightHelper( hemiLight, 50 );
    					// scene.add( helper1 );

				      dirLight = new THREE.DirectionalLight( 0xffffff, 0.4 );
			        dirLight.position.set( 0, 4000, 3000 );
			        scene.add( dirLight );

         //      var dirLight2 = new THREE.DirectionalLight( 0xffffff, 0.04 );
         //      dirLight2.position.set( 200, 600, 4000 );
         //      scene.add( dirLight2 );

			      //   const helper = new THREE.DirectionalLightHelper( dirLight2, 350 );
					    // scene.add( helper );

			        dirLight.castShadow = true;
			        dirLight.shadow.mapSize.width = 3048;
			        dirLight.shadow.mapSize.height = 3048;

			        var d = 1500;

			        dirLight.shadow.camera.left = -d;
			        dirLight.shadow.camera.right = d;
			        dirLight.shadow.camera.top = d;
			        dirLight.shadow.camera.bottom = -d;
			        dirLight.shadow.camera.near = 40;
			        dirLight.shadow.camera.far = 10000;
			        dirLight.shadow.bias = 0.00001;
			        dirLight.shadow.darkness = 0.2;

				}

        // function createImage() {

        //       var dataURL = renderer.domElement.toDataURL();
        //       var link = document.createElement("a");
        //       link.download = "Vase.png";
        //       link.href = dataURL;
        //       link.target = "_blank";
        //       link.click();

        //       }
		
	
	function drawVase(radiusTop,radiusBottom, height, legTop, legCurve, legWidth, legOffset,bellyTop,bellyCurve,bellyWidth,bellyOffset, neckTop,neckCurve,neckWidth,neckOffset, mouthCurve,mouthWidth, mouthOffset,materialId,color){

				// console.log('drawVase:' + radiusTop);
					// console.log('##############');
				 //    console.log('radiusTopslider'+ radiusTop);
		   //      	console.log('radiusBottom'+radiusBottom);
		   //      	console.log('height'+height);
		   //      	console.log('legTop'+legTop); 
		   //      	console.log('legCurve'+legCurve); 
		   //      	console.log('legWidth'+legWidth);
		   //      	console.log('legOffset'+legOffset);
		   //      	console.log('bellyTop'+bellyTop);
		   //      	console.log('bellyCurve'+bellyCurve);
		   //      	console.log('bellyWidth'+bellyWidth);
		   //      	console.log('bellyOffset'+bellyOffset);
		   //      	console.log('neckTop'+neckTop);
		   //      	console.log('neckCurve'+neckCurve);
		   //      	console.log('neckWidth'+neckWidth);
		   //      	console.log('neckOffset'+neckOffset);
		   //      	console.log('mouthCurve'+mouthCurve);
		   //      	console.log('mouthWidth'+mouthWidth);
		   //      	console.log('mouthOffset'+mouthOffset);  	

		   		// Cube_texture
			    	var path = "examples/textures/cube/skyboxsun25deg/";
		        	var format = '.jpg';
		        	var urls = [
		            path + 'px' + format, path + 'nx' + format,
		            path + 'py' + format, path + 'ny' + format,
		            path + 'pz' + format, path + 'nz' + format
		          	];


				   var reflectionCube = new THREE.CubeTextureLoader().load( urls );
				   var refractionCube = new THREE.CubeTextureLoader().load( urls );
			       refractionCube.mapping = THREE.SphericalReflectionMapping;
			       refractionCube.format = THREE.RGBFormat;
			 	
			 	//Vase
			 	var radialSegments = 100;
			 	var heightSegments = 100;
			 	var openEnded = true;		        

		  		if(cylinder5){
		  			scene.remove(cylinder5); 	
		  		}
		  		// if(!cylinder5){

	  			cylinderGeom5 = new THREE.CylinderGeometry(radiusTop, 
	  				radiusBottom, height, radialSegments, heightSegments, openEnded);

		  		var materials = [
					new THREE.MeshPhysicalMaterial( {color: color, side: THREE.DoubleSide } ),
					new THREE.MeshPhysicalMaterial( {color: 0xffffff, side: THREE.DoubleSide, transparent: true, opacity: 0 } ),
					// new THREE.MeshPhysicalMaterial( {color: color, side: THREE.DoubleSide } ),
				  ];

				  var materials_shiny = [
					new THREE.MeshPhysicalMaterial( { color: color, clearcoat:1 , roughness: 0.8,
								clearcoatRoughness: 0.1, reflectivity: 0, side: THREE.DoubleSide, envMap: refractionCube, envMapIntensity: 0.4} ),
					new THREE.MeshPhysicalMaterial( {color: 0xffffff, side: THREE.DoubleSide, transparent: true, opacity: 0 } ),
					// new THREE.MeshPhysicalMaterial( {color: 'red', side: THREE.DoubleSide } ),
					];

					// var cylinder5 = new THREE.Mesh( cylinderGeom5, materials );
					if (materialId == 0) {
					cylinder5 = new THREE.Mesh(cylinderGeom5, materials_shiny);
					}

					else{
					cylinder5 = new THREE.Mesh(cylinderGeom5, materials);
					}

					scene.add(cylinder5);
					cylinder5.position.x = x_cylinder;            
				  cylinder5.position.z = z_cylinder;
				  cylinder5.position.y = y_cylinder;
				  cylinder5.scale.set(70,70,70);
          // cylinder5.scale.set(7,7,7);


					// cylinderGeomClean.vertices.forEach(v => {
					  cylinderGeom5.vertices.forEach(v => {
						var vertex = new THREE.Vector3(); // temp vector
						vertex.copy(v); // copy current vertex to the temp vector
						vertex.setY(0); // leave x and z (thus the vector is parallel to XZ plane)
						vertex.normalize(); // normalize
						

						//leg
						if (v.y <= legTop) {
							var tmp = new THREE.Vector3(); // temp vector
							tmp.copy(vertex);
							vertex.multiplyScalar(Math.sin(v.y/legCurve+legOffset) * legWidth); 
						  vertex.add(tmp);
						}

						//belly
						if (v.y <= bellyTop && v.y > legTop ) {
							var tmp = new THREE.Vector3(); // temp vector
							tmp.copy(vertex);
						  vertex.multiplyScalar(Math.sin(v.y/bellyCurve+bellyOffset) * bellyWidth); 
						  vertex.add(tmp);
						}

						//neck
						if (v.y <= neckTop && v.y > bellyTop ) {
							var tmp = new THREE.Vector3(); // temp vector
						  tmp.copy(vertex);
							vertex.multiplyScalar(Math.sin(v.y/neckCurve+neckOffset) * neckWidth) 
							vertex.add(tmp);
						}

						//mouth
						if (v.y > neckTop ) {
							var tmp = new THREE.Vector3(); // temp vector
							tmp.copy(vertex);
						  vertex.multiplyScalar(Math.sin(v.y/mouthCurve+mouthOffset) * mouthWidth); 
						  vertex.add(tmp);
						}
						
						v.add(vertex);
            vertex.needsUpdate = true;
            // add the temp vector to the current vertex
						cylinderGeom5.vertices.push(v);
				})

          

          var radiusBottom_new;
          var y_minimum = 0;

        // Find the y value of the bottom points (lowest y)
        cylinderGeom5.vertices.forEach(v => {
            if (v.y<y_minimum){
              y_minimum = v.y;
            }
        });

        // Find all the points with that y value
        var bottom_vertices = [];
            cylinderGeom5.vertices.forEach(v => {
            if (v.y==y_minimum){
              bottom_vertices.push(v);
            }
        });

        // Compute the diameter of the bottom
        var max_dist = 0;
        for(var j=0; j<bottom_vertices.length; j++){
          var dist = bottom_vertices[0].distanceTo(bottom_vertices[j]);
          if(dist > max_dist){
            max_dist = dist;
          }
        }
        

          capBottomGeo = new THREE.CircleGeometry(max_dist/2, 100);
          capBottomMat = new THREE.MeshPhysicalMaterial({color: color, side: THREE.DoubleSide});
          capBottomMesh = new THREE.Mesh( capBottomGeo, capBottomMat );
          capBottomMesh.position.y = -height / 2;
          capBottomMesh.rotation.x = Math.PI / 2;
          cylinder5.add(capBottomMesh);

        cylinderGeom5.computeVertexNormals();
        cylinder5.verticesNeedUpdate = true;
		}

    // function getAbsolutePosition(mesh){
    //   mesh.updateMatrixWorld();
    //   const box = new THREE.Box3();
    //   mesh.geometry.computeBoundingBox();
    //   box.copy( mesh.geometry.boundingBox ).applyMatrix4( mesh.matrixWorld );
    //   console.log(box);
    // }
		


		function onMouseMove(event) {
		  var mousePosition = new THREE.Vector3(0, 0, 0.5);
		  mousePosition.x = 2 * (event.clientX / window.innerWidth) - 1;
		  mousePosition.y = 1 - 2 * (event.clientY / window.innerHeight);
		  mousePosition.unproject(camera);
		  var raycaster = new THREE.Raycaster(camera.position, mousePosition.sub(camera.position).normalize());
		  var intersects = raycaster.intersectObjects(scene.children);
			// controls.enabled = intersects.length > 0;

      if (changeCursor===true) {
			if(intersects.length > 0) {
		        $('html,body').css('cursor', 'url(mouse.svg), move');
            // $('.cursor').css("display", "block");
            
		    } else {
		        $('html,body').css('cursor', 'default');
		    }
      }
		}

		function glazed(){
			$('#glazed').addClass('selected');
			$('#clay').removeClass('selected');
			update = true;
			showVal(0);
		}

		function clay(){
			$('#clay').addClass('selected');
			$('#glazed').removeClass('selected');
			update = true;
			showVal(0);
		}


		function trigger(eventName, elementName){
			var event = document.createEvent("Event");
			event.initEvent(eventName, false, true); 
			document.getElementById(elementName).dispatchEvent(event);
		}


		function myFunction(event) {
			  var x = document.getElementById("controls");
			  if (x.style.display === "block") {
			    x.style.display = "none";
			  } else {
			    x.style.display = "block";
			  }
			}


		function onNextClick( event ) {		
			cylinderGeom5.verticesNeedUpdate = false;
			update = false;

			counter += 1;
			array_of_functions[counter%array_of_functions.length]();
			document.getElementById("vasename").innerHTML = vases_names[counter%vases_names.length];
			
			update = true;
			cylinderGeom5.verticesNeedUpdate = true;
			trigger("input", "mouthOffset");
      console.log(counter);

		}

		function onPreClick( event ) {
		
			cylinderGeom5.verticesNeedUpdate = false;
			update = false;

			counter += -1;
			if (counter==-1) {
				counter=array_of_functions.length-1;
			}
			array_of_functions[counter%array_of_functions.length]();
			document.getElementById("vasename").innerHTML = vases_names[counter%vases_names.length];
			
			update = true;
			cylinderGeom5.verticesNeedUpdate = true;
			trigger("input", "mouthOffset");

		}

		function drawVase1(){
			colorbrown();
		  glazed();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
			document.getElementById("vasename").innerHTML = "T-01";

			document.getElementById("radiusTopslider").value = 0.4;
			document.getElementById("radiusBottom").value = 2.2;
			document.getElementById("height").value = 11;

			document.getElementById("legTop").value = -6;
			document.getElementById("legCurve").value = 0.4;
			document.getElementById("legWidth").value = 0.2;
			document.getElementById("legOffset").value = 1;

			document.getElementById("bellyTop").value = 3.6;
			document.getElementById("bellyCurve").value = 0.4;
			document.getElementById("bellyWidth").value = 0.2;
			document.getElementById("bellyOffset").value = 0.62;

			document.getElementById("neckTop").value = 5.36;
			document.getElementById("neckCurve").value = 0.72;
			document.getElementById("neckWidth").value = 0.6;
			document.getElementById("neckOffset").value = -1.8;

			document.getElementById("mouthCurve").value = 0.63;
			document.getElementById("mouthWidth").value = 0.54;
			document.getElementById("mouthOffset").value = 3.35;
			trigger("input", "mouthOffset");
		}

		function drawVase2(){

			clay();
			colorpink();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
			document.getElementById("vasename").innerHTML = "T-02";
			document.getElementById("radiusTopslider").value = 0.4;
			document.getElementById("radiusBottom").value = 0.7;
			document.getElementById("height").value = 13;

			document.getElementById("legTop").value = -7;
			document.getElementById("legCurve").value = 0.3;
			document.getElementById("legWidth").value = 0.1;
			document.getElementById("legOffset").value = -3.8;

			document.getElementById("bellyTop").value = 3.4;
			document.getElementById("bellyCurve").value = 3;
			document.getElementById("bellyWidth").value = 1.8;
			document.getElementById("bellyOffset").value = 2;

			document.getElementById("neckTop").value = 6.37;
			document.getElementById("neckCurve").value = 0.68;
			document.getElementById("neckWidth").value = 0.4;
			document.getElementById("neckOffset").value = 4.41;

			document.getElementById("mouthCurve").value = 1;
			document.getElementById("mouthWidth").value = 0.51;
			document.getElementById("mouthOffset").value = 2;
			trigger("input", "mouthOffset");
		}

			
		// 	function drawVase3(){

		// 	coloryellow();
  //     document.getElementById("vasename").innerHTML = "T-03";
		// 	document.getElementById("radiusTopslider").value = 0.6;
		// 	document.getElementById("radiusBottom").value = 0.4;
		// 	document.getElementById("height").value = 10;

		// 	document.getElementById("legTop").value = -6;
		// 	document.getElementById("legCurve").value = 0.3;
		// 	document.getElementById("legWidth").value = 0.1;
		// 	document.getElementById("legOffset").value = -3.6;

		// 	document.getElementById("bellyTop").value = 10;
		// 	document.getElementById("bellyCurve").value = 3;
		// 	document.getElementById("bellyWidth").value = 1.7;
		// 	document.getElementById("bellyOffset").value = 2;

		// 	document.getElementById("neckTop").value = 4.8;
		// 	document.getElementById("neckCurve").value = 1.5;
		// 	document.getElementById("neckWidth").value = 1;
		// 	document.getElementById("neckOffset").value = 3;

		// 	document.getElementById("mouthCurve").value = 1;
		// 	document.getElementById("mouthWidth").value = 0;
		// 	document.getElementById("mouthOffset").value = 4.6;
		// 	trigger("input", "mouthOffset");

		// }

    function drawVase3(){

      coloryellow();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "T-03";
      document.getElementById("radiusTopslider").value = 1.82;
      document.getElementById("radiusBottom").value = 0.4;
      document.getElementById("height").value = 13.54;

      document.getElementById("legTop").value = -5.3;
      document.getElementById("legCurve").value = 2.42;
      document.getElementById("legWidth").value = 1.8;
      document.getElementById("legOffset").value = -3.46;

      document.getElementById("bellyTop").value = 3.33;
      document.getElementById("bellyCurve").value = 3.2;
      document.getElementById("bellyWidth").value = 2.41;
      document.getElementById("bellyOffset").value = 2.12;

      document.getElementById("neckTop").value = 5.31;
      document.getElementById("neckCurve").value = 0.65;
      document.getElementById("neckWidth").value = 0.51;
      document.getElementById("neckOffset").value = -1.92;

      document.getElementById("mouthCurve").value = 2.5;
      document.getElementById("mouthWidth").value = 2.11;
      document.getElementById("mouthOffset").value = 4.16;
      trigger("input", "mouthOffset");

    }

			function drawVase4(){

      colorbrown();
      glazed();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "T-04";
			document.getElementById("radiusTopslider").value = 0.1;
			document.getElementById("radiusBottom").value = 1.31151;
			document.getElementById("height").value = 9.7;

			document.getElementById("legTop").value = -6;
			document.getElementById("legCurve").value = 0.3;
			document.getElementById("legWidth").value = 0.1;
			document.getElementById("legOffset").value = -3.6;

			document.getElementById("bellyTop").value = 3.67;
			document.getElementById("bellyCurve").value = 2.26;
			document.getElementById("bellyWidth").value = 1.97;
			document.getElementById("bellyOffset").value = 1.7;

			document.getElementById("neckTop").value = 4.65;
			document.getElementById("neckCurve").value = 0.71;
			document.getElementById("neckWidth").value = 0.66;
			document.getElementById("neckOffset").value = 4.8;


			document.getElementById("mouthCurve").value = 0.88;
			document.getElementById("mouthWidth").value = 0.66; 
			document.getElementById("mouthOffset").value = -0.26; 
			trigger("input", "mouthOffset");

		}

		function drawVase5(){
      colorwhite();
      clay();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "T-05";
			document.getElementById("radiusTopslider").value = 0.28009;
			document.getElementById("radiusBottom").value = 1;
			document.getElementById("height").value = 14;

			document.getElementById("legTop").value = -6.28;
			document.getElementById("legCurve").value = 0.707;
			document.getElementById("legWidth").value = 0.1;
			document.getElementById("legOffset").value = -3.6;

			document.getElementById("bellyTop").value = 2.89;
			document.getElementById("bellyCurve").value = 3.2;
			document.getElementById("bellyWidth").value = 2.6;
			document.getElementById("bellyOffset").value = 2.01;

			document.getElementById("neckTop").value = 6.36;
			document.getElementById("neckCurve").value = 1.04;
			document.getElementById("neckWidth").value = 0.87;
			document.getElementById("neckOffset").value = -0.35;

			document.getElementById("mouthCurve").value = 1.04;
			document.getElementById("mouthWidth").value = 0.87; 
			document.getElementById("mouthOffset").value = -0.35; 
			trigger("input", "mouthOffset");

		}

		function drawVase6(){
      coloryellow();
      clay();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "T-06";
			document.getElementById("radiusTopslider").value = 1.45;
			// trigger("change", "radiusTopslider");
			document.getElementById("radiusBottom").value = 1.81;
			// trigger("change", "radiusBottom");
			document.getElementById("height").value = 14;
			// trigger("change", "height");

			document.getElementById("legTop").value = -7.2;
			// trigger("change", "legTop");
			document.getElementById("legCurve").value = 0.3;
			// trigger("change", "legCurve");
			document.getElementById("legWidth").value = 0.1;
			// trigger("change", "legWidth");
			document.getElementById("legOffset").value = -3.8;
			// trigger("change", "legOffset");

			document.getElementById("bellyTop").value = 3.62;
			// trigger("change", "bellyTop");
			document.getElementById("bellyCurve").value = 3.2;
			// trigger("change", "bellyCurve");
			document.getElementById("bellyWidth").value = 2.6;
			// trigger("change", "bellyWidth");
			document.getElementById("bellyOffset").value = 1.99;
			// trigger("change", "bellyOffset");

			document.getElementById("neckTop").value = 6.72;
			// trigger("change", "neckTop");
			document.getElementById("neckCurve").value = 0.74;
			// trigger("change", "neckCurve");
			document.getElementById("neckWidth").value = 0.42;
			// trigger("change", "neckWidth");
			document.getElementById("neckOffset").value = 4.41;
			// trigger("change", "neckOffset");

			document.getElementById("mouthCurve").value = 1.02;
			// trigger("change", "mouthCurve");
			document.getElementById("mouthWidth").value = 0.49; 
			// trigger("change", "mouthWidth");
			document.getElementById("mouthOffset").value = 1.08; 
			trigger("input", "mouthOffset");

		}


    function drawVase7(){
      colorpink();
      glazed();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "T-07";
      document.getElementById("radiusTopslider").value = 1.37;
      document.getElementById("radiusBottom").value = 1.73;
      document.getElementById("height").value = 13.5;

      document.getElementById("legTop").value = -6.05;
      document.getElementById("legCurve").value = 0.2;
      document.getElementById("legWidth").value = 0.2;
      document.getElementById("legOffset").value = -0.1;

      document.getElementById("bellyTop").value = 3.5;
      document.getElementById("bellyCurve").value = 0.2;
      document.getElementById("bellyWidth").value = 0.2;
      document.getElementById("bellyOffset").value = -0.1;

      document.getElementById("neckTop").value = 5.05;
      document.getElementById("neckCurve").value = 0.2;
      document.getElementById("neckWidth").value = 0.2;
      document.getElementById("neckOffset").value = -0.1;

      document.getElementById("mouthCurve").value = 0.2;
      document.getElementById("mouthWidth").value = 0.2; 
      document.getElementById("mouthOffset").value = -0.1; 
      trigger("input", "mouthOffset");

    }

    // function drawVase7(){
    //   colorpink();
    //   glazed();
    //   document.getElementById("vasename").innerHTML = "T-07";
    //   document.getElementById("radiusTopslider").value = 0.8;
    //   document.getElementById("radiusBottom").value = 1.8;
    //   document.getElementById("height").value = 15;

    //   document.getElementById("legTop").value = -7.64;
    //   document.getElementById("legCurve").value = 0.3;
    //   document.getElementById("legWidth").value = 0.1;
    //   document.getElementById("legOffset").value = -3.8;

    //   document.getElementById("bellyTop").value = 3.5;
    //   document.getElementById("bellyCurve").value = 2.4;
    //   document.getElementById("bellyWidth").value = 0.94;
    //   document.getElementById("bellyOffset").value = 1.99;

    //   document.getElementById("neckTop").value = 5.05;
    //   document.getElementById("neckCurve").value = 2.51;
    //   document.getElementById("neckWidth").value = 0.91;
    //   document.getElementById("neckOffset").value = 2.06;

    //   document.getElementById("mouthCurve").value = 1.5;
    //   document.getElementById("mouthWidth").value = 0.83; 
    //   document.getElementById("mouthOffset").value = 0.84; 
    //   trigger("input", "mouthOffset");

    // }

    function drawVase8(){

      clay();
      coloryellow();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "T-08";
      document.getElementById("radiusTopslider").value = 1.18;
      document.getElementById("radiusBottom").value = 2.34;
      document.getElementById("height").value = 15;

      document.getElementById("legTop").value = -7.85;
      document.getElementById("legCurve").value = 0.3;
      document.getElementById("legWidth").value = 0.1;
      document.getElementById("legOffset").value = -3.6;

      document.getElementById("bellyTop").value = 2.26;
      document.getElementById("bellyCurve").value = 0.81;
      document.getElementById("bellyWidth").value = 0.91;
      document.getElementById("bellyOffset").value = 1.85;

      document.getElementById("neckTop").value = 6.12;
      document.getElementById("neckCurve").value = 0.81;
      document.getElementById("neckWidth").value = 0.91;
      document.getElementById("neckOffset").value = 1.85;

      document.getElementById("mouthCurve").value = 0.81;
      document.getElementById("mouthWidth").value = 0.91;
      document.getElementById("mouthOffset").value = 1.85;
      trigger("input", "mouthOffset");
    }

    function drawVase9(){

      glazed();
      colorwhite();
      x_cylinder = 0;
      y_cylinder = -30;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "T-09";
      document.getElementById("radiusTopslider").value = 1.15;
      document.getElementById("radiusBottom").value = 3;
      document.getElementById("height").value = 15;

      document.getElementById("legTop").value = -6.93;
      document.getElementById("legCurve").value = 1.71;
      document.getElementById("legWidth").value = 2.13;
      document.getElementById("legOffset").value = -3.65;

      document.getElementById("bellyTop").value = 3.34;
      document.getElementById("bellyCurve").value = 2.27;
      document.getElementById("bellyWidth").value = 2.16;
      document.getElementById("bellyOffset").value = 1.7;

      document.getElementById("neckTop").value = 6.85;
      document.getElementById("neckCurve").value = 0.71;
      document.getElementById("neckWidth").value = 0.66;
      document.getElementById("neckOffset").value = 4.8;

      document.getElementById("mouthCurve").value = 1.01;
      document.getElementById("mouthWidth").value = 0.83;
      document.getElementById("mouthOffset").value = 1.8;
      trigger("input", "mouthOffset");
    }

    function drawVase10(){

      clay();
      colorbrown();
      x_cylinder = 0;
      y_cylinder = 20;
      z_cylinder = 120;
      document.getElementById("vasename").innerHTML = "";
      document.getElementById("radiusTopslider").value = 1.62;
      document.getElementById("radiusBottom").value = 1.87;
      document.getElementById("height").value = 10.68;

      document.getElementById("legTop").value = -5;
      document.getElementById("legCurve").value = 3;
      document.getElementById("legWidth").value = 0.2;
      document.getElementById("legOffset").value = 1.61;

      document.getElementById("bellyTop").value = 1.78;
      document.getElementById("bellyCurve").value = 3;
      document.getElementById("bellyWidth").value = 0.2;
      document.getElementById("bellyOffset").value = 1.61;

      document.getElementById("neckTop").value = 4.56;
      document.getElementById("neckCurve").value = 3;
      document.getElementById("neckWidth").value = 0.2;
      document.getElementById("neckOffset").value = 1.61;

      document.getElementById("mouthCurve").value = 3;
      document.getElementById("mouthWidth").value = 0.2;
      document.getElementById("mouthOffset").value = 1.61;
      trigger("input", "mouthOffset");

    }



       window.onresize = function(event) {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize($(container).width(), $(container).height());
        // renderer.setSize( window.innerWidth, window.innerHeight );
        
      };

      




	// STL export
	var STLExporter = function () {};

	STLExporter.prototype = {

	constructor: STLExporter,

	parse: ( function () {

		var vector = new THREE.Vector3();
		var normalMatrixWorld = new THREE.Matrix3();

		return function ( scene ) {

			var output = '';

			output += 'solid exported\n';

			scene.traverse( function ( object ) {

				if ( object instanceof THREE.Mesh ) {

					var geometry = object.geometry;
					var matrixWorld = object.matrixWorld;
					var mesh = object;

					if ( geometry instanceof THREE.Geometry ) {

						var vertices = geometry.vertices;
						var faces = geometry.faces;

						normalMatrixWorld.getNormalMatrix( matrixWorld );

						for ( var i = 0, l = faces.length; i < l; i ++ ) {
							var face = faces[ i ];

							vector.copy( face.normal ).applyMatrix3( normalMatrixWorld ).normalize();

							output += '\tfacet normal ' + vector.x + ' ' + vector.y + ' ' + vector.z + '\n';
							output += '\t\touter loop\n';

							var indices = [ face.a, face.b, face.c ];

							for ( var j = 0; j < 3; j ++ ) {
								var vertexIndex = indices[ j ];
								if (mesh.geometry.skinIndices.length == 0) {
									vector.copy( vertices[ vertexIndex ] ).applyMatrix4( matrixWorld );
									output += '\t\t\tvertex ' + vector.x + ' ' + vector.y + ' ' + vector.z + '\n';
								} else {
									vector.copy( vertices[ vertexIndex ] ); //.applyMatrix4( matrixWorld );
									
									// see https://github.com/mrdoob/three.js/issues/3187
									boneIndices = [];
									boneIndices[0] = mesh.geometry.skinIndices[vertexIndex].x;
									boneIndices[1] = mesh.geometry.skinIndices[vertexIndex].y;
									boneIndices[2] = mesh.geometry.skinIndices[vertexIndex].z;
									boneIndices[3] = mesh.geometry.skinIndices[vertexIndex].w;
									
									weights = [];
									weights[0] = mesh.geometry.skinWeights[vertexIndex].x;
									weights[1] = mesh.geometry.skinWeights[vertexIndex].y;
									weights[2] = mesh.geometry.skinWeights[vertexIndex].z;
									weights[3] = mesh.geometry.skinWeights[vertexIndex].w;
									
									inverses = [];
									inverses[0] = mesh.skeleton.boneInverses[ boneIndices[0] ];
									inverses[1] = mesh.skeleton.boneInverses[ boneIndices[1] ];
									inverses[2] = mesh.skeleton.boneInverses[ boneIndices[2] ];
									inverses[3] = mesh.skeleton.boneInverses[ boneIndices[3] ];

									skinMatrices = [];
									skinMatrices[0] = mesh.skeleton.bones[ boneIndices[0] ].matrixWorld;
									skinMatrices[1] = mesh.skeleton.bones[ boneIndices[1] ].matrixWorld;
									skinMatrices[2] = mesh.skeleton.bones[ boneIndices[2] ].matrixWorld;
									skinMatrices[3] = mesh.skeleton.bones[ boneIndices[3] ].matrixWorld;
									
									var finalVector = new THREE.Vector4();
									for(var k = 0; k<4; k++) {
										var tempVector = new THREE.Vector4(vector.x, vector.y, vector.z);
										tempVector.multiplyScalar(weights[k]);
										//the inverse takes the vector into local bone space
										tempVector.applyMatrix4(inverses[k])
										//which is then transformed to the appropriate world space
										.applyMatrix4(skinMatrices[k]);
										finalVector.add(tempVector);
									}
									output += '\t\t\tvertex ' + finalVector.x + ' ' + finalVector.y + ' ' + finalVector.z + '\n';
								}
							}
							output += '\t\tendloop\n';
							output += '\tendfacet\n';
						}
					}
				}

			} );

			output += 'endsolid exported\n';

			return output;
		};
	}() )
};

// Use FileSaver.js 'saveAs' function to save the string
function saveSTL( scene, name ){  
  var exporter = new STLExporter();
  var stlString = exporter.parse( scene );
  
  var blob = new Blob([stlString], {type: 'text/plain'});
  
  saveAs(blob, name + '.stl');
}


		

		</script>
	</body>
</html>
